<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<link href="../static/css/main.css" rel="stylesheet" />
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/main.js"></script>
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<link href="../static/css/bootstrap.min.css" rel="stylesheet">

<script>
  var dialog;
  var dialogP;
  window.onload=function(){
    dialog=document.getElementById("infoModal");
    dialogP=document.getElementById("Per");
  };
  function showD(){
    dialog.style.display='block';
    fade.style.display='block';
  };
  function showP(){
    dialogP.style.display='block';
    fade.style.display='block';
  };
  function closeD(){
    dialog.style.display='none';
    fade.style.display='none';
  };  
  function closeP(){
    dialogP.style.display='none';
    fade.style.display='none';
  };  
  function closeDetailed(){
    {% for user in arr %}
    w{{ user.ID }}.style.display='none';
    {% endfor %}
    fade.style.display='none';
  }; 
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      headerToolbar: {
        left: 'prev,next,today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
      },
          eventClick: function(arg) {
          {% for i in range(total) %} 
          if(arg.event.title == '{{ qu[i].ID }} {{ qu[i].Sub }}'){
            w{{ qu[i].ID }}.style.display='block';
            fade.style.display='block';
          }
        {% endfor %}
      },
      navLinks: true,
      businessHours: true, 
      selectable: true,
      dayMaxEvents: true,
      events: [
              {% for i in range(total) %}
                  {
                  title: '{{ qu[i].ID }} {{ qu[i].Sub }}',
                  start: '{{ qu[i].StartDate }}',
                  end: '{{ qu[i].EndDate }}',
                    {% if qu[i].State == 'In Coming' %}
                        color: '#696969',
                    {% elif qu[i].State == 'On Going' %}
                        color: '#E6D933',
                    {% else %}
                        color: '#257e4a',
                    {% endif %}
                  },
              {% endfor %}
      ]
    });

    calendar.render();
  });

function che() {
    var msg = "確定要修改嗎？";
    if (confirm(msg)==true){
        return true
    }else{
        return false
    }
}
</script>
<script>
function self() {
    var mylist = document.getElementById("sel");
    document.getElementById("selList").value = mylist.options[mylist.selectedIndex].text;
}
</script>
<style>
  html{
    margin:0 auto;
    max-width: 1100px;
  }
  
  body {
    margin: 40px 10px;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #calendar {
    max-width: 1100px;
    margin: 0 auto;
  }
  
  .infoModal{
    border: none;
    box-shadow: 0 0px 10px rgb(163, 163, 163);
    border-radius: 10px;
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translate(-120px, 0px);
    width: 240px;
    padding-top: -15px;
    padding: 15px;
    background-color: #eee;
    z-index: 10;
    display: none;
  }
  .infoModalP{
    border: none;
    box-shadow: 0 0px 10px rgb(163, 163, 163);
    position: fixed;
    top: 10%;
    width: auto;
    height: 80%;
    padding-top: -15px;
    padding: 15px;
    margin: auto;
    background-color: #eee;
    z-index: 10;
    display: none;
    overflow-y:auto;
    overflow-x: hidden;
  }
  #infoModal::backdrop {
    background-color: rgba(0, 0, 0, 0.1);
  }
  .close{
    position: absolute; 
    top: 5px; 
    right:15px;
    font-size: 15px;
    cursor: pointer;
    font-size: 30px;
  }
  .black_overlay {
      display: none;
      position: fixed;
      top: 0%;
      left: 0%;
      width: 100%;
      height: 100%;
      background-color: black;
      z-index: 5;
      -moz-opacity: 0.8;
      opacity: .60;
    }
    .te{
      color: #fff;
      color: var(--fc-button-text-color, #fff);
      background-color: #2C3E50;
      background-color: var(--fc-button-bg-color, #2C3E50);
      border-color: #2C3E50;
      border-color: var(--fc-button-border-color, #2C3E50);
      border-radius: 0.25em;
      height:30px;
      margin-bottom:10px;
    }
    .te:focus {
    outline: 0px ;
  }
  .te::-moz-focus-inner {
    padding: 0;
    border-style: none;
  }
  .circle{
    border-radius: 25px;
    width: 20px;
    height: 20px; 
    display: inline-block;
  }
.cont{
  display: flex;
  justify-content: center;
  align-items: center; 
}
</style>
</head>
<body>
<div style="max-width: 1100px; align-items: center;">
  <form action="/">
      <input type="submit" value="返回" class="te" style="width:50px; ">
  </form>
  <button onclick="showD();" style="width:100px;position: absolute; margin-top:-40px;margin-left:65px;" class="te" >新增聯絡人</button>
  <div id="infoModal" class="infoModal">
    <div onclick="closeD();" class="close">X</div>
    <div id="newPer">
      <form action="calendar_ne" method="post">
        <p style="font-family:'標楷體';font-size: 24px;font-weight:bold; margin-top: -5px;">新增聯絡人</p>
        <p>SR 名稱: </p><input type="text" id="Name" name="Name">
        <p>SR MVPN: </p><input type="text" id="MVPN" name="MVPN">
        <p>SR Mail: </p><input type="email" id="Mail" name="Mail">
        <input type="submit" value="確定" style="right:20px;position: absolute;">
      </form>
    </div>
  </div>
  <input type="button" value="聯絡人清單" class="te" onclick="showP();" style="width:100px;position: absolute; margin-top:-40px;margin-left:180px;" >
  <div class="cont">
    <div id="Per" class="infoModalP">
      <div onclick="closeP();" class="close">X</div>
        <table cellpadding="5" style="border: 1px solid;">
          <thead>
              <tr style="border: 1px solid;">
                  <th style="border: 1px solid;">SR 姓名</th>
                  <th style="border: 1px solid;">SR MVPN</th>
                  <th style="border: 1px solid;" colspan="2">SR Mail</th>
              </tr>
          </thead>
          <tbody>
            {% for SR in quSR %}
            <form  action="calendar_ne" method="post">
              <tr style="border: 1px solid;">
                <td style="border: 1px solid;" id="SName" Name="SName"><input type="text" value="{{ SR.Name }}" disabled="disabled"></dr>
                {% if SR.MVPN is not none %}
                    <td style="border: 1px solid;" id="Sid" Name="Sid"><input type="text" value="{{ SR.MVPN }}" disabled="disabled" size="5px"></td>
                {% else %}
                    <td style="border: 1px solid;" id="Sid" Name="Sid"><input type="text" value="" disabled="disabled" size="5px"></td>
                {% endif %}
                <td style="border: 1px solid;" id="SMail" Name="SMail"><input type="text" value="{{ SR.Mail }}" disabled="disabled" size="40px"></td>
                <td><input type="submit" value="修改" onclick="javascript:return che()"></td> 
              </tr>
            <form>
            {% endfor %}
          </tbody>
        </table>    
      </div>
    </div>
  </div>
  <div style="margin-top:-40px;float:right ">
    <div class="circle" style="background-color: #696969;"></div><p style="display:inline-block; margin-left:5px; vertical-align:middle;">In Coming</p>
    <div class="circle" style="background-color: #E6D933;"></div><p style="display:inline-block; margin-left:5px; vertical-align:middle;">On Going</p>
    <div class="circle" style="background-color: #257e4a;"></div><p style="display:inline-block; margin-left:5px; vertical-align:middle;">Completed</p>
  </div>  
  <div id="fade" class="black_overlay"></div>
</div>
  <div id="calendar"></div>
  {% for user in arr %}
    <div style="justify-content: center; align-items: center; display: flex;" >
        <div id="w{{ user.ID }}" name="ID"  style="background-color: white;align-items: center;z-index: 12; width: 80%; height: 50%;top: 20%;position: fixed;display: none;">
                <div onclick="closeDetailed();" class="close">X</div>
            <table style="width: 100%;text-align: center; font-size: 24px; " class="htm">
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="1" style="text-align: center;">SR 編號</th>
                    <th colspan="4" style="text-align: center;">預計開始日</th>
                    <th colspan="4" style="text-align: center;">預計結束日</th>
                    <th colspan="1" style="text-align: center;">SR 狀態</th>
                </tr>
                <tr>
                    <td colspan="1">{{ user.ID }}</td>
                    <td colspan="4">{{ user.StartDate }}</td>
                    <td colspan="4">{{ user.EndDate }}</td>
                    <td colspan="1">{{ user.State }}</td>
                </tr>
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="6" style="text-align: center;">SR 開單部門</th>
                    <th colspan="2" style="text-align: center;">SR 類別</th>
                    <th colspan="2" style="text-align: center;">優先等級</th>
                </tr>
                <tr>
                    <td colspan="6">{{ user.CreWGro }}</td>
                    <td colspan="2">{{ user.SR }}</td>
                    <td colspan="2">{{ user.CoxT }}</td>
                </tr>
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="6" style="text-align: center;">SR 主旨</th>
                    <th colspan="2" style="text-align: center;">SR 開單人</th>
                    <th colspan="2" style="text-align: center;">實驗室支援</th>
                </tr>
                <tr>
                    <td colspan="6">{{ user.Sub }}</td>
                    <td colspan="2">{{ user.CreN }}</td>
                    <td colspan="2">{{ user.SpN }}</td>
                <tr>
                </tr>
            </table>
           	<div class="row" sytle="q">
           		<div class="col-md-12">
           			<div class="row">
           				<div class="col-md-6">
           					 <span class="badge badge-default" sytle="width:100%">信件內容:</span>
           					<br>
           					<textarea name="content" style="width:100%;height:101.5px;margin-top:10px;border: 3px solid #A9A9A9;resize: none;" value="內容"></textarea>				</div>
           				<div class="col-md-6">
           					 <span class="badge badge-default" sytle="width:100%">聯絡人:</span>
           						 <br>
                                    <select id="sel" name="sel" style="width:250px" onchange="self()">
                                    {% for SR in quSR %}
                                        {% if SR.MVPN is not none %}
                                            <option>{{ SR.Name }}({{ SR.MVPN }})</option>
                                        {% else %}
                                            <option>{{ SR.Name }}()</option>
                                        {% endif %}
                                    {% endfor %}
                                    </select>
                                    <p><input type="text" id="selList" size="20"></p>
           					<button type="button" class="btn btn-success" style="bottom:5px;right:15px; position:absolute;">送出</button>
           				</div>
           			</div>
           		</div>
           	</div>
        </div>
    </div>
    {% endfor %}
</body>
</html>
