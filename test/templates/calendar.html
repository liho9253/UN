<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<link href="../static/css/main.css" rel="stylesheet" />
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/main.js"></script>
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<link href="../static/css/bootstrap.min.css" rel="stylesheet">

<script>
  var dialog;
  window.onload=function(){
    dialog=document.getElementById("infoModal");
  };
  function showD(){
    dialog.style.display='block';
    fade.style.display='block';
  };
  function closeD(){
    dialog.style.display='none';
    fade.style.display='none';
  };  
  function closeDetailed(){
    {% for user in arr %}
    w{{ user.ID }}.style.display='none';
    {% endfor %}
    fade.style.display='none';
  }; 
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      headerToolbar: {
        left: 'prev,next,today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
      },
          eventClick: function(arg) {
          {% for i in range(total) %} 
          if(arg.event.title == '{{ qu[i].Sub }}'){
            w{{ qu[i].ID }}.style.display='block';
            fade.style.display='block';
          }
        {% endfor %}
      },
      navLinks: true,
      businessHours: true, 
      selectable: true,
      dayMaxEvents: true,
      events: [
              {% for i in range(total) %}
                  {
                  title: '{{ qu[i].Sub }}',
                  start: '{{ qu[i].StartDate }}',
                  end: '{{ qu[i].EndDate }}',
                    {% if qu[i].State == 'In Coming' %}
                        color: '#0B14D9',
                    {% elif qu[i].State == 'On Going' %}
                        color: '#257e4a',
                    {% else %}
                        color: '#D90B37',
                    {% endif %}
          constraint: '1',
                  },
                  { 
                    groupId: '1',
                    start: '2017-09-04T10:00:00',
                    end: '2017-09-05T10:00:00',
                    display: 'background'
                  },
              {% endfor %}
      ]
    });

    calendar.render();
  });

</script>

<style>
  html{
    margin:    0 auto;
    max-width: 1100px;
  }
  
  body {
    margin: 40px 10px;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #calendar {
    max-width: 1100px;
    margin: 0 auto;
  }
  
  .infoModal{
    border: none;
    box-shadow: 0 0px 10px rgb(163, 163, 163);
    border-radius: 10px;
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translate(-120px, 0px);
    width: 240px;
    padding-top: -15px;
    padding: 15px;
    background-color: #eee;
    z-index: 10;
    display: none;
  }
  #infoModal::backdrop {
    background-color: rgba(0, 0, 0, 0.1);
  }
  .close{
    position: absolute; 
    top: 5px; 
    right:15px;
    font-size: 15px;
    cursor: pointer;
    font-size: 30px;
  }
  .black_overlay {
      display: none;
      position: fixed;
      top: 0%;
      left: 0%;
      width: 100%;
      height: 100%;
      background-color: black;
      z-index: 5;
      -moz-opacity: 0.8;
      opacity: .80;
    }
    .te{
      color: #fff;
      color: var(--fc-button-text-color, #fff);
      background-color: #2C3E50;
      background-color: var(--fc-button-bg-color, #2C3E50);
      border-color: #2C3E50;
      border-color: var(--fc-button-border-color, #2C3E50);
      border-radius: 0.25em;
      height:30px;
      margin-bottom:10px;
    }
    .te:focus {
    outline: 0px ;
  }
  .te::-moz-focus-inner {
    padding: 0;
    border-style: none;
  }
</style>
</head>
<body>
<div style="max-width: 1100px; align-items: center;">
  <form action="/">
      <input type="submit" value="返回" class="te" style="width:50px; ">
  </form>
  <button onclick="showD();" style="width:100px;position: absolute; margin-top:-40px;margin-left:45px;" class="te" >新增聯絡人</button>
  <div id="infoModal" class="infoModal">
    <div onclick="closeD();" class="close">X</div>
    <div id="newPer">
      <form action="">
        <p style="font-family:'標楷體';font-size: 24px;font-weight:bold; margin-top: -5px;">新增聯絡人</p>
        <p>SR 名稱: </p><input type="text">
        <p>SR ID: </p><input type="text">
        <p>SR Mail: </p><input type="text">
        <input type="button" value="確定" style="right:20px;position: absolute;">
      </form>
    </div>
  </div>
  <div id="fade" class="black_overlay"></div>
</div>
  <div id="calendar"></div>
  {% for user in arr %}
    <div style="justify-content: center; align-items: center; display: flex;" >
        <div id="w{{ user.ID }}" name="ID"  style="background-color: white;align-items: center;z-index: 12; width: 80%; height: 50%;top: 20%;position: fixed;display: none;">
                <div onclick="closeDetailed();" class="close">X</div>
            <table style="width: 100%;text-align: center; font-size: 24px; " class="htm">
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="1" style="text-align: center;">SR 編號</th>
                    <th colspan="4" style="text-align: center;">預計開始日</th>
                    <th colspan="4" style="text-align: center;">預計結束日</th>
                    <th colspan="1" style="text-align: center;">SR 狀態</th>
                </tr>
                <tr>
                    <td colspan="1">{{ user.ID }}</td>
                    <td colspan="4">{{ user.StartDate }}</td>
                    <td colspan="4">{{ user.EndDate }}</td>
                    <td colspan="1">{{ user.State }}</td>
                </tr>
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="6" style="text-align: center;">SR 開單部門</th>
                    <th colspan="2" style="text-align: center;">SR 類別</th>
                    <th colspan="2" style="text-align: center;">優先等級</th>
                </tr>
                <tr>
                    <td colspan="6">{{ user.CreWGro }}</td>
                    <td colspan="2">{{ user.SR }}</td>
                    <td colspan="2">{{ user.CoxT }}</td>
                </tr>
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="6" style="text-align: center;">SR 主旨</th>
                    <th colspan="2" style="text-align: center;">SR 開單人</th>
                    <th colspan="2" style="text-align: center;">實驗室支援</th>
                </tr>
                <tr>
                    <td colspan="6">{{ user.Sub }}</td>
                    <td colspan="2">{{ user.CreN }}</td>
                    <td colspan="2">{{ user.SpN }}</td>
                <tr>
                </tr>
            </table>
           	<div class="row" sytle="q">
           		<div class="col-md-12">
           			<div class="row">
           				<div class="col-md-6">
           					 <span class="badge badge-default" sytle="width:100%">信件內容:</span>
           					<br>
           					<textarea name="content" style="width:100%;height:101.5px;margin-top:10px;border: 3px solid #A9A9A9;resize: none;" value="內容"></textarea>				</div>
           				<div class="col-md-6">
           					 <span class="badge badge-default" sytle="width:100%">聯絡人:</span>
           						 <br>
                                <select id="sel" name="sel" style="width:55%">
                                {% for SR in quSR %}
                                    {% if SR.ID is not none %}
                                        <option>{{ SR.Name }}({{ SR.ID }})</option>
                                    {% else %}
                                        <option>{{ SR.Name }}()</option>
                                    {% endif %}
                                {% endfor %}
                                </select>
           					<button type="button" class="btn btn-success" style="bottom:5px;right:15px; position:absolute;">送出</button>
           				</div>
           			</div>
           		</div>
           	</div>
        </div>
    </div>
    {% endfor %}
</body>
</html>
