<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<link href="../static/css/main.css" rel="stylesheet" />
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/main.js"></script>
<script>
  var dialog;
  window.onload=function(){
    dialog=document.getElementById("infoModal");
  };
  function showD(){
    dialog.style.display='block';
    fade.style.display='block';
  };
  function closeD(){
    dialog.style.display='none';
    fade.style.display='none';
  };  
  function closeDetailed(){
    {% for user in arr %}
    w{{ user.ID }}.style.display='none';
    {% endfor %}
    fade.style.display='none';
  }; 
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
      },
      eventClick: function(arg) {
        {% for user in arr %} 
            w{{ user.ID }}.style.display='block';
        {% endfor %}
        fade.style.display='block';
      },
      initialDate: '2018-01-05',
      navLinks: true,
      businessHours: true, 
      editable: true,
      selectable: true,
      dayMaxEvents: true,
      events: [
              {% for i in range(total) %}
                  {
                  title: '{{ qu[i].Sub }}',
                  start: '{{ qu[i].StartDate }}',
                  end: '{{ qu[i].EndDate }}',
                    {% if qu[i].State == 'In Coming' %}
                        color: '#0B14D9',
                    {% elif qu[i].State == 'On Going' %}
                        color: '#257e4a',
                    {% else %}
                        color: '#D90B37',
                    {% endif %}
          constraint: '1',
                  },
                  { 
                    groupId: '1',
                    start: '2017-09-04T10:00:00',
                    end: '2017-09-05T10:00:00',
                    display: 'background'
                  },
              {% endfor %}
      ]
    });

    calendar.render();
  });

</script>
<style>

  body {
    margin: 40px 10px;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #calendar {
    max-width: 1100px;
    margin: 0 auto;
  }
  
  .infoModal{
    border: none;
    box-shadow: 0 0px 10px rgb(163, 163, 163);
    border-radius: 10px;
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translate(-120px, 0px);
    width: 240px;
    padding-top: -15px;
    padding: 15px;
    background-color: #eee;
    z-index: 10;
    display: none;
  }
  #infoModal::backdrop {
    background-color: rgba(0, 0, 0, 0.1);
  }
  .close{
    position: absolute; 
    top: 5px; 
    right:6px;
    font-size: 15px;
    cursor: pointer;
    font-size: 30px;
  }
  .black_overlay {
      display: none;
      position: fixed;
      top: 0%;
      left: 0%;
      width: 100%;
      height: 100%;
      background-color: black;
      z-index: 5;
      -moz-opacity: 0.8;
      opacity: .80;
    }
</style>
</head>
<body>
  <button onclick="showD();">新增聯絡人</button>
  <div id="infoModal" class="infoModal">
    <div onclick="closeD();" class="close">X</div>
    <div id="newPer">
      <form action="">
        <p style="font-family:'標楷體';font-size: 24px;font-weight:bold; margin-top: -5px;">新增聯絡人</p>
        <p>SR 名稱: </p><input type="text" value="">
        <p>SR Mail: </p><input type="text" value="">
      </form>
    </div>
  </div>
  <div id="fade" class="black_overlay"></div>
  <div id="calendar"></div>
  {% for user in arr %}
    <div style="justify-content: center; align-items: center; display: flex;" >
        <div id="w{{ user.ID }}" name="ID"  style="background-color: white;align-items: center;z-index: 12; width: 80%; height: 30%;top: 20%;position: fixed;display: none;">
                <div onclick="closeDetailed();" class="close">X</div>
            <table style="width: 100%;text-align: center; font-size: 24px; " class="htm">
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="3.5">預計開始日</th>
                    <th colspan="3.5">預計結束日</th>
                    <th colspan="3">SR 狀態</th>
                </tr>
                <tr>
                    <td colspan="3.5">{{ user.StartDate }}</td>
                    <td colspan="3.5">{{ user.EndDate }}</td>
                    <td colspan="3">{{ user.State }}</td>
                </tr>
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="3" style="text-align: center;">結案日</th>
                    <th colspan="3" style="text-align: center;">SR 開單部門</th>
                    <th colspan="2" style="text-align: center;">SR 類別</th>
                    <th colspan="2" style="text-align: center;">優先等級</th>
                </tr>
                <tr>
                    <td colspan="3">{{ user.CloseDate }}</td>
                    <td colspan="3">{{ user.CreWGro }}</td>
                    <td colspan="2">{{ user.SR }}</td>
                    <td colspan="2">{{ user.CoxT }}</td>
                </tr>
                <tr style="color:#FFFFFF;background-color: crimson;">
                    <th colspan="6" style="text-align: center;">SR 主旨</th>
                    <th colspan="2" style="text-align: center;">SR 開單人</th>
                    <th colspan="2" style="text-align: center;">實驗室支援</th>
                </tr>
                <tr>
                    <td colspan="6">{{ user.Sub }}</td>
                    <td colspan="2">{{ user.CreN }}</td>
                    <td colspan="2">{{ user.SpN }}</td>
                <tr>
                </tr>
            </table>
        </div>
    </div>
    {% endfor %}
</body>
</html>
